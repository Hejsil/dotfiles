#!/bin/sh

cmd=$*
[ -z "$cmd" ] && [ -f 'Cargo.toml' ] &&
    cmd='cargo clippy && cargo build'
[ -z "$cmd" ] && [ -f 'build.zig' ] &&
    cmd='zig build --prominent-compile-errors'

fd -e h -e hh -e hpp -e c -e cc -e cpp -e cs -e rs -e toml -e zig -e graphql -e js -e html -e css \
    -e kt -e java \
    --exclude 'zig-cache' | exec entr -crs "$cmd"
