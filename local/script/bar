#!/bin/execlineb -P


# Wait for whatever is needed for lemonbar to run
# TODO: This should probably not sleep
foreground { sleep 0.1s }

backtick font       { xgetres bar.font }
multisubstitute {
    define   bar_height 26
    importas font       font
    importas color0     COLOR0
    importas color5     COLOR5
    importas color8     COLOR8
    importas color10    COLOR10
    importas color11    COLOR11
}

foreground { bspc config top_padding $bar_height }
background {
    pipeline {
        lemonbar-maker
            --background \#$color0
            --low        \#$color11
            --mid        \#$color10
            --high       \#$color8
    }
    lemonbar
        -g x$bar_height
        -f $font
        -B \#$color0
        -F \#$color5
        -u 2
        -n lemonbar
}

foreground { loopwhilex -x 0 xdo id -a lemonbar }

pipeline {
     foreground { xdo id -n root }
     xdo id -a lemonbar
}
foreground { xargs "-d\n" xdo below -t }

wait
